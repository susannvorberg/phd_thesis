# Interpretation of Coupling Matrices {#interpreting-coupling-matrices}

Contact prediction methods learning a *Potts model* for the [MSA](#abbrev) of a protein familiy, map the inferred 20 x 20 coupling matrices $w_{ij}$ onto scalar values to obtain contact scores for each residue pair as outlined in section \@ref(post-processing-heuristics). 
By doing so, the full information contained in coupling matrices is lost:

  - the contribution of individual couplings $\wijab$
  - the direction of couplings (positive or negative)
  - the correlation between couplings $\wijab$ and $\wijcd$
  - inherent biological meaning
  
The following analyses give some intuition for the information contained in coupling matrices.

## Single Coupling Values Carry Evidence of Contacts {#correlation-between-couplings-and-class}

Given the success of [DCA](#abbrev) methods, it is clear that the inferred couplings $\wij$ are good indicators of spatial proximity for residue pairs. 
As described in section \@ref(post-processing-heuristics), a contact score for a residue pair is commonly computed as the Frobenius norm over the coupling matrix: $||\wij||_2 = \sqrt{\sum_{a,b=1}^{20} \wijab}$


The left plot in Figure \@ref(fig:sq-coupling-correlation) shows the correlation between squared coupling values $(\wijab)^2$ and binary contact class (contact=1, non-contact=0) for approximately 100.000 residue pairs per class (for details see methods section \@ref(method-coupling-correlation)).
All couplings have a positive class correlation, meaning the stronger the squared coupling value, the more likely a contact can be inferred. 
Generally, couplings that involve any aliphatic amino acid (I, L, V) or alanine express the strongest class correlation. 
In contrast, C-C or pairs involving charged residus (R, E, K, D) or tryptophane correlate only weakly with contact class.
Interestingly, C-C and couplings involving charged residues have the highest standard-deviation among all couplings as can be seen in the right plot in Figure \@ref(fig:sq-coupling-correlation). 
It can be hypothesized that these couplings considerably contribute to false positive predictions when using the Frobenius norm as a contact score; 
they can have high squared values (high standard deviation) that do not correlate well with being a contact. 

(ref:caption-sq-coupling) **Left** Pearson correlation of squared coupling values $(\wijab)^2$ with contact class (contact=1, non-contact=0). **Right** Standard deviation of squared coupling values. Dataset contains 100.000 residue pairs per class (for details see methods section \@ref(method-coupling-correlation)). Contacts are defined as residue pairs with $\Cb < 8 \angstrom$ and non-contacts as residue pairs with $\Cb > 25 \angstrom$.


```{r sq-coupling-correlation, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/squared_couplings_correlation_and_stddev_notitle.png", out.width='100%', fig.cap = '(ref:caption-sq-coupling)', fig.align='center'}
knitr::include_url("img/coupling_matrix_analysis/squared_couplings_correlation_and_stddev_notitle.html", height="550px")
```

Apparantly, different couplings are of varying importance for contact inference and have distinct characteristics. 
But looking at the raw coupling values (without squaring), these charateristics become even more pronounced. 

The left plot in Figure \@ref(fig:coupling-correlation) shows the correlation of raw coupling values $\wijab$ with contact class.
Interestingly, in contrast to the findings for squared coupling values, couplings for charged residue pairs (R, E, K, D) have the strongest class correlation (positive and negative), whereas aliphatic couplings correlate to a much lesser extent.
This implies that absolute (squared) coupling strength for aliphatic couplings is a better indicator for contacts than the raw signed coupling value.
On the contrary, the raw signed coupling values for charged residue pairs are much more indicative of a contact than the sheer magnitude of their squared values.

Raw couplings for aromatic pairs or C-C pairs correlate only weakly with contact class. 
For these pairs neither coupling strength, nor the sign of the coupling value seems to be a good indicator for a contact.

(ref:caption-coupling-correlation) **Left** Pearson correlation of raw signed coupling values $\wijab$ with contact class (contact=1, non-contact=0). **Right** Standard deviation of coupling values. Dataset contains 100.000 residue pairs per class (for details see section \@ref(method-coupling-correlation)). Contacts are defined as residue pairs with $\Cb < 8 \angstrom$ and non-contacts as residue pairs with $\Cb > 25 \angstrom$. 

```{r coupling-correlation, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/couplings_correlation_and_stddev_notitle.png", out.width='100%', fig.cap = '(ref:caption-coupling-correlation)'}
knitr::include_url("img/coupling_matrix_analysis/couplings_correlation_and_stddev_notitle.html", height = "600px")
```


Of course, looking only at correlations can be misleading if there are non-linear patterns in the data, for example higher order dependencies between couplings. 
For this reason it is advisable to take a more detailed view at coupling matrices and the distributions of their values.

## Physico-Chemical Fingerprints in Coupling Matrices


The correlation analysis of coupling matrices in the last section revealed that certain couplings are more indicative of a contact than others. 
Individual coupling matrices for a residue pair that is in physcial contact often display striking patterns that agree with the previous findings. 
Most often, these patterns allow a biological interpreation of the coupling values that reveal details of the interdependency between both residues.

Figure \@ref(fig:coupling-matrix-ionic-interaction) visualizes the inferred coupling matrix for a residue pair using the pseudo-likelihood method.
Clearly visible is a cluster of strong coupling values for charged and polar residues (E,D,K,R,Q). 
Positive coupling values can be observed between positively charged residues (R,K) and negatively charged residues (E,D), whereas couplings between equally charged residues have negative values. 
The coupling matrix perfectly reflects the interaction preference for residues forming salt bridges. 
Indeed, in the protein structure the first residue (glutamic acid) forms a salt bridge with the second residue (lysine) as can be seen in the left Figure \@ref(fig:coupling-matrix-pymol).

(ref:caption-coupling-matrix-ionic-interaction) Coupling matrix computed with pseudo-likelihood for residues 6 and 82 in protein 1awq chain A. Size of the bubbles represents coupling strength and color represents positive (red) and negative (blue) coupling values. Bars at the x-axis and y-axis represent the corresponding single potentials for both residue positions. Height of the bars stands for potential strength and color for positive (red) and negative (blue) values.

```{r coupling-matrix-ionic-interaction, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/coupling_matrix_1a9xA05_6_82_notitle.png", out.width='90%', fig.cap = '(ref:caption-coupling-matrix-ionic-interaction)'}
knitr::include_url("img/coupling_matrix_analysis/coupling_matrix_1a9xA05_6_82_notitle.html", height = "600px")
```

Figure \@ref(fig:coupling-matrix-hydrophobic-interaction) visualizes the coupling matrix for a pair of hydrophobic residues.
Hydrophobic pairings have strong coupling values but the couplings also reflect a sterical constraint.
Alanine as a small hydrophobic residue is favoured at either of both residue positions as it has strong positive couplings with isoleucine, leucine and methionine.
But alanine is disfavoured to appear at both positions at the same time as the A-A coupling is negative.
Figure \@ref(fig:coupling-matrix-pymol) illustrates the location of the two residues in the protein core. Here, hydrophobic residues are densely packed and the limited space allows for only small hydrophobic residues.

(ref:caption-coupling-matrix-hydrophobic-interaction) Coupling matrix computed with pseudo-likelihood for residues 29 and 39 in protein 1ae9 chain A. Size of the bubbles represents coupling strength and color represents positive (red) and negative (blue) coupling values. Bars at the x-axis and y-axis represent the corresponding single potentials for both residues. Height of the bars stands for potential strength and color for positive (red) and negative (blue) values.

```{r coupling-matrix-hydrophobic-interaction, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/coupling_matrix_1ae9A00_29_39_notitle.png", out.width='90%', fig.cap = '(ref:caption-coupling-matrix-hydrophobic-interaction)'}
knitr::include_url("img/coupling_matrix_analysis/coupling_matrix_1ae9A00_29_39_notitle.html", height = "600px")
```

<!---
<iframe width="750" height="750" frameborder="0" scrolling="no" src="img/coupling_matrix_analysis/coupling_matrix_1awqA00_92_129_notitle.html">
-->

(ref:caption-coupling-matrix-pymol) Interactions between protein side chains. **Left**: residue 6 (glutamic acid) forms a salt bridge with residue 82 (lysine) in protein 1awq, chain A. **Right**: residue 29 (alanine) and residue 39 (leucine) within the hydrophobic core of protein 1ae9 chain A.   

```{r coupling-matrix-pymol, echo = FALSE, out.width = '50%', fig.show = 'hold', fig.cap = '(ref:caption-coupling-matrix-pymol)'}
knitr::include_graphics(c("img/coupling_matrix_analysis/1a9xA05_6_82.png", "img/coupling_matrix_analysis/1ae9A00_29_39.png"))
```


Many more biological interpretable signals can be identified from coupling matrices, including pi-cation interactions (see Appendix \@ref(pi-cation)), aromatic-proline interactions (see Appendix \@ref(aromatic-proline)), sulfur-aromatic interactions or disulphide bonds (see Appendix \@ref(disulfide)). 

Coucke and collegues performed a thorough quantitative analysis of coupling matrices selected from confidently predicted residue pairs [@Coucke2016].
They showed that eigenmodes obtained from a spectral analysis of averaged coupling matrices are closely related to physico-chemical properties of amino acid interactions, like electrostaticity, hydrophobicity, steric interactions or disulphide bonds. 
By looking at specific populations of residues, like buried and exposed residues or residues from specific protein classes (small, mainly $\alpha$, etc), the eigenmodes of corresponding coupling matrices are found to capture very characteristic interactions for each class, e.g. rare disulfide contacts within small proteins and hydrophilic contacts between exposed residues. 
Their study confirms the qualitative observations presented above that amino acid interactions can leave characteristic physico-chemical fingerprints in coupling matrices. 


## Coupling Profiles Vary with Distance

Analyses in the previous sections showed that certain coupling values correlate more or less strong with contact class and that coupling matrices for contacts express biological meaningfull patterns. 

More insights can be obtained by looking at the distribution of distinct coupling values for contacts, non-contacts and arbitrary populations of residue pairs. 
Figure \@ref(fig:1d-coupling-profile-0-5) shows the distribution of selected couplings for filtered residue pairs within a $\Cb$ distance $< 5\angstrom$ (see methods section \@ref(method-coupling-profile) for details). 
The distribution of R-E and E-E coupling values is shifted and skewed towards positive and negative values respectively. 
This is in accordance with attracting electrostatic interactions between the positively charged side chain of arginine and the negatively charged side chain of gluatamic acid and also with repulsive interactions between the two negatively charged gluatamic acid side chains.
Coupling values for cysteine pairs (C-C) have a broad distribution that is skewed towards positive values, reflecting the strong signals obtained from covalent disulphide bonds.
The broad distribution for C-C, R-E and E-E agrees with the observation in section \@ref(correlation-between-couplings-and-class) that these specific coupling values have large standard deviations and that for charged residue pairings the signed coupling value is a strong indicator of a contact.

Hydrophobic pairs like V-I have an almost symmetric coupling distribution, confirming the finding that the direction of coupling is not indicative of a true contact whereas the strength of the coupling is.
The hydrophobic effect that determines hydrophobic interactions is not specific or directed. 
Therefore, hydrophobic interaction partners can commonly be substituted by other hydrophobic residues, which explains the not very pronounced positive coupling signal compared to more specific interactions, e.g ionic interactions. 
The distribution of aromatic coupling values like F-W is slightly skewed towards negative values, accounting for steric hindrance of their large side chains at small distances. 

(ref:caption-1d-coupling-profile-0-5) Distribution of selected couplings for filtered residue pairs with $\Cb$ distance $< 5\angstrom$ (see methods section \@ref(method-coupling-profile) for details). Number of coupling values used to determine the distribution is given in brackets in the legend. R-E = coupling for pairings of arginine and glutamic acid, C-C = coupling for pairings between cystein residues, V-I = coupling for pairings of valine and isoleucine, F-W = coupling for pairing sof phenylalanine and tryptophane, E-E = coupling for pairings between glutamic acid residues.

```{r 1d-coupling-profile-0-5, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/1d_coupling_profile_0_5.png", out.width='90%', fig.cap = '(ref:caption-1d-coupling-profile-0-5)', fig.align='center'}
knitr::include_url("img/coupling_matrix_analysis/1d_coupling_profile_0_5.html")
```

In an intermediate $\Cb$ distance range between $8\angstrom$ and $12\angstrom$ the distributions for all coupling values are centered close to zero and are less broad. 
The distributions are still shifted and skewed, but much less pronounced as it has been observed for the distributions at $\Cb$ distance $< 5\angstrom$. 
For aromatic pairs like F-W, the distribution of coupling values has very long tails, suggesting rare but strong couplings for aroamtic side chains at this distance.

(ref:caption-1d-coupling-profile-8-12) Distribution of selected couplings for filtered residue pairs with $\Cb$ distances between $8\angstrom$ and $12 \angstrom$ (see methods section \@ref(method-coupling-profile) for details). Number of coupling values used to determine the distribution is given in brackets in the legend. R-E = coupling for pairings of arginine and glutamic acid, C-C = coupling for pairings between cystein residues, V-I = coupling for pairings of valine and isoleucine, F-W = coupling for pairing sof phenylalanine and tryptophane, E-E = coupling for pairings between glutamic acid residues.

```{r 1d-coupling-profile-8-12, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/1d_coupling_profile_8_12.png", out.width='100%', fig.cap = '(ref:caption-1d-coupling-profile-8-12)'}
knitr::include_url("img/coupling_matrix_analysis/1d_coupling_profile_8_12.html")
```


Figure \@ref(fig:1d-coupling-profile-20-50) shows the distribution of selected couplings for residue pairs far apart in the protein structure ($\Cb$ distance $> 20\angstrom$).  
The distribution for all couplings is centered at zero and has small variance. 
Only for C-C coupling values, the distribution has a long tail for positve values, presumably arising from the fact that the maximum entropy model cannot distuinguish highly conserved signals of multiple disulphide bonds within a protein. 
This observation also agrees with the previous finding in section \@ref(correlation-between-couplings-and-class) that C-C coupling values, albeit having large standard-deviations, correlate only weakly with contact class.
The same arguments apply to couplings of aromatic pairs that have a comparably broad distribution and do not correlate strongly with contact class.
The strong coevolution signals for aromatic pairs even at high distance ranges might be a result of insufficient disentangling of transitive effects, as aromatic residues are known to form network-like structures in the protein core that stabilize protein structure (see Figure \@ref(fig:aromatic-network) in Appendix)[@Burley1985]. 



(ref:caption-1d-coupling-profile-20-50) Distribution of selected couplings for filtered residue pairs with $\Cb$ distances between $20\angstrom$ and $50 \angstrom$ (see methods section \@ref(method-coupling-profile) for details). Number of coupling values used to determine the distribution is given in brackets in the legend. R-E = coupling for pairings of arginine and glutamic acid, C-C = coupling for pairings between cystein residues, V-I = coupling for pairings of valine and isoleucine, F-W = coupling for pairing sof phenylalanine and tryptophane, E-E = coupling for pairings between glutamic acid residues.

```{r 1d-coupling-profile-20-50, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/1d_coupling_profile_20_50.png", out.width='100%', fig.cap = '(ref:caption-1d-coupling-profile-20-50)'}
knitr::include_url("img/coupling_matrix_analysis/1d_coupling_profile_20_50.html")
```


## Higher Order Dependencies Between Couplings 

The analyses in the previous sections focused on single coupling values picked from the $20 \times 20$-dimensional coupling matrices $\wij$.
As mentioned before, analysing only single dimension might be misleading and further insights might be concealed in a higher order relationships.
Unfortunately, it is not possible to reasonably visualize the high dimensional coupling matrices. 

But taking a look at two dimensional coupling scatter plots already reveals some further insights and confirms the previous observations that couplings reflect biological relevant amino acid interactions.
Figure \@ref(fig:2d-coupling-profile-re-er-0-8) and \@ref(fig:2d-coupling-profile-re-ee-0-8) illustrate the distribution of couplings at $\Cb$ distances less than $8\angstrom$ between the attractive ionic pairings of E-R and R-E and between the ionic pairing R-E and the repulsive pair of equally charged residues E-E,  respectively.
Whereas coupling values for R-E and E-R are positively correlated, coupling values for R-E and E-E are negatively correlated. 


(ref:caption-2d-coupling-profile-re-er-0-8) Two-dimensional distribution of coupling values R-E and E-R for approximately 10000 residue pairs with $\Delta\Cb < 8\angstrom$. The distribution is almost symmetric and the coupling values are positively correlated. Residue pairs have been filtered for sequence separation, percentage of gaps and evidence in alignment as explained in methods section \@ref(method-coupling-profile). 

```{r 2d-coupling-profile-re-er-0-8, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/pairwise_couplings_R-E_E-R_Cbdistance_0_8_notitle.png", out.width='75%', fig.show = 'hold', fig.cap = '(ref:caption-2d-coupling-profile-re-er-0-8)'}
knitr::include_url("img/coupling_matrix_analysis/pairwise_couplings_R-E_E-R_Cbdistance_0_8_notitle.html", height="550px")
```

(ref:caption-2d-coupling-profile-re-ee-0-8) Two-dimensional distribution of coupling values R-E and E-E for approximately 10000 residue pairs with $\Delta\Cb < 8\angstrom$. The distribution is almost symmetric and the coupling values are negatively correlated. Residue pairs have been filtered for sequence separation, percentage of gaps and evidence in alignment as explained in methods section \@ref(method-coupling-profile). 


```{r 2d-coupling-profile-re-ee-0-8, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/pairwise_couplings_R-E_E-E_Cbdistance_0_8_notitle.png", out.width='75%', fig.cap = '(ref:caption-2d-coupling-profile-re-ee-0-8)'}
knitr::include_url("img/coupling_matrix_analysis/pairwise_couplings_R-E_E-E_Cbdistance_0_8_notitle.html", height="550px")
```

Figure \@ref(fig:2d-coupling-profile-vi-il-0-8) shows distributions between couplings for hydrophobic pairings that are almost symmetric and broadly centered around zero.
Coupling distributions for residue pairs that are not physically interacting ($\Cb >> 8 \angstrom$) resemble the distribution for hydrophobic pairings in that there is no correlation, but at high distance the  distributions are much tighter centered around zero.

(ref:caption-2d-coupling-profile-vi-il-0-8) Two-dimensional distribution of coupling values R-E and E-E for approximately 10000 residue pairs with $\Delta\Cb < 8\angstrom$. The coupling values are symmetrically distributed around zero without visible correlation. Residue pairs have been filtered for sequence separation, percentage of gaps and evidence in alignment as explained in methods section \@ref(method-coupling-profile). 

```{r 2d-coupling-profile-vi-il-0-8, echo = FALSE, screenshot.alt="img/coupling_matrix_analysis/pairwise_couplings_V-I_I-L_Cbdistance_0_8_notitle.png", out.width='75%', fig.cap = '(ref:caption-2d-coupling-profile-vi-il-0-8)'}
knitr::include_url("img/coupling_matrix_analysis/pairwise_couplings_V-I_I-L_Cbdistance_0_8_notitle.html", height="550px")
```





